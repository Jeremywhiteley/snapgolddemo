<?xml version="1.0" encoding="UTF-8"?>
<ContentPage
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:controls="clr-namespace:PhotoSharingApp.Forms.Controls;assembly=PhotoSharingApp.Forms"
    xmlns:lottie="clr-namespace:Lottie.Forms;assembly=Lottie.Forms"
    x:Class="PhotoSharingApp.Forms.CameraPage"
    Title="Upload"
    Icon="camera.png">

    <!-- Remove title on Android -->
    <ContentPage.Title>
        <OnPlatform x:TypeArguments="x:String">
            <On Platform="Android" Value=""/>
        </OnPlatform>
    </ContentPage.Title>

    <!-- Toolbar Items -->
    <TabbedPage.ToolbarItems>
        <ToolbarItem
            Name="Library"
            Icon="library.png"
            Clicked="LibraryButton_Clicked"/>
    </TabbedPage.ToolbarItems>
    
	<ContentPage.Content>
         <Grid
            RowSpacing="0"
            ColumnSpacing="0">
            
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <controls:CameraViewFinder
                x:Name="ViewFinder"
                Grid.Row="0"
                HorizontalOptions="FillAndExpand"
                VerticalOptions="FillAndExpand">
            </controls:CameraViewFinder>

            <Image
                x:Name="PhotoPreview"
                Grid.Row="0"
                Aspect="AspectFit"
                VerticalOptions="Start"/>

            <StackLayout
                x:Name="CameraControls"

                Grid.Row="1"
                Orientation="Horizontal"
                VerticalOptions="End"
                HorizontalOptions="Center"
                Spacing="10"
                Padding="20">
                
                <!--<Button Text="Init" Clicked="Handle_Clicked" TextColor="Black" BackgroundColor="{StaticResource SubtleColor}" WidthRequest="80" />-->
                <Button Text="Take a picture" Clicked="TakeButton_Clicked"  BackgroundColor="{StaticResource AccentColor}" WidthRequest="120" TextColor="White" />
                <!--<Button Text="Turn" TextColor="Black" BackgroundColor="{StaticResource SubtleColor}" WidthRequest="80" />-->
            </StackLayout>

            <StackLayout
                x:Name="UploadControls"
                IsVisible="false"
                Grid.Row="2"
                Spacing="5"
                VerticalOptions="End"
                Padding="20">

                <Label Text="Caption" Style="{StaticResource ControlHeaderStyle}" />
                <Entry Text="{Binding Caption}" Margin="0,0,0,15"  />

                <Label Text="Category" Style="{StaticResource ControlHeaderStyle}" />
                <Picker
                    x:Name="CategoryPicker"
                    Margin="0,0,0,15"
                    ItemsSource="{Binding CategoryOptions}"
                    SelectedItem="{Binding SelectedCategory}"
                    ItemDisplayBinding="{Binding Name}" />

                <StackLayout
                    Orientation="Horizontal"
                    Spacing="10">

                    <Button
                        Text="Upload"
                        Clicked="UploadButton_Clicked"
                        HorizontalOptions="FillAndExpand"
                        Command="{Binding SaveCommand}"
                        BackgroundColor="{StaticResource AccentColor}"
                        TextColor="White"/>
                    
                    <Button
                        Text="Cancel"
                        Clicked="CancelButton_Clicked"
                        HorizontalOptions="FillAndExpand"
                        Command="{Binding DeleteCommand}"
                        BackgroundColor="{StaticResource SubtleColor}"
                        TextColor="Black"/>
                </StackLayout>
            </StackLayout>

            <Grid
                x:Name="LoadingOverlay"
                IsVisible="false"
                Grid.RowSpan="3"
                BackgroundColor="{StaticResource AccentColor}">
                
                <lottie:AnimationView
                    Margin="120"
                    x:Name="LoadingAnimation"
                    Animation="spinnerloading.json"
                    Loop="True"
                    VerticalOptions="FillAndExpand"
                    HorizontalOptions="FillAndExpand" />
            </Grid>
        </Grid>
	</ContentPage.Content>
</ContentPage>
